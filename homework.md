# Тестирование страницы оплаты

## 1. Модульные тесты:

- Если `card_number` содержит не 16 цифр, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `card_number` содержит символы, отличные от цифр, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `card_holder` содержит символы, отличные от латинских букв, пробелов или дефисов, тестируемый метод возвращает
  400 с сообщением об ошибке;
- Если `card_holder` содержит более одного пробела подряд, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `card_expiration` не соответствует формату `мм/гг`, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `card_expiration` содержит истекшую дату, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `cvv` не состоит из трёх цифр, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `sum` не содержит разделителя в виде запятой, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `sum` невозможно преобразовать в число, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если `order_number` превышает 16 символов, тестируемый метод возвращает 400 с сообщением об ошибке;
- Если сервис A возвращает код 403, тестируемый метод возвращает 403 с сообщением об ошибке;
- Если сервис A возвращает код 200, но метод `setOrderIsPaid` выбрасывает исключение, тестируемый метод возвращает 500 с
  сообщением об ошибке;
- Если метод `setOrderIsPaid` возвращает `true`, тестируемый метод возвращает 200.

## 2. Интеграционные тесты:

- Проверяем связку «Фронт-Бэк»:
    - Если `card_number` содержит символы, отличные от цифр, после получения ответа от бэка на фронте выделяется поле
      «Номер карты» красной рамкой;
    - Если `card_expiration` содержит истекшую дату, после получения ответа от бэка на фронте выделяется поле «Срок
      действия карты» красной рамкой.

- Проверяем связку «Бэк-Сервис A»:
    - Если данные карты валидны, но сервис A возвращает 403, бэк возвращает 403, что приводит к отображению на фронте
      сообщения: «Списание невозможно. Проверьте данные карты»;
    - Если сервис A возвращает 200, данные передаются в репозиторий для записи успешной оплаты.

- Проверяем связку «Бэк-Репозиторий»:
    - Если данные о заказе и сумме не совпадают, метод `setOrderIsPaid` выбрасывает исключение, что приводит к
      возвращению 500 и отображению на фронте сообщения «Ошибка обработки заказа»;
    - Если запись успешна, метод возвращает 200, что отображается на фронте как «Оплата успешно выполнена».

## 3. Системные тесты:

- Если все данные валидны, сервис A подтверждает списание, а запись в репозиторий успешна, пользователь видит сообщение
  «Оплата успешно выполнена» и перенаправляется на страницу подтверждения заказа;
- Если `cvv` неверен, пользователь видит сообщение «Не удалось списать данные с карты, проверьте реквизиты» и
  соответствующее поле выделяется красной рамкой;
- Если сервис A возвращает 403, пользователь видит сообщение «Списание невозможно. Проверьте данные карты»;
- Если при записи в репозиторий происходит ошибка, пользователь видит сообщение «Ошибка обработки заказа. Пожалуйста,
  повторите попытку позже».  
