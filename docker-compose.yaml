version: '3'

services:
  php_server:
    build:
      context: ./docker/server
      dockerfile: Dockerfile
    container_name: 'php_server'
    volumes:
    - ./code:/data
    - "phpsocket:/var/socket/phpsocket.sock"
    networks:
      - php_app

  php_client:
    build:
      context: ./docker/client
      dockerfile: Dockerfile
    container_name: 'php_client'
    volumes:
      - ./code:/data
      - "phpsocket:/var/socket/phpsocket.sock"
    networks:
      - php_app
    depends_on:
      - php_server

volumes:
  phpsocket:

networks:
  php_app:
    driver: bridge