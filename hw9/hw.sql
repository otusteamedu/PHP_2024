--
-- PostgreSQL database dump
--

-- Dumped from database version 16.3 (Debian 16.3-1.pgdg120+1)
-- Dumped by pg_dump version 16.3

-- Started on 2024-07-26 21:29:06 UTC

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 218 (class 1259 OID 16442)
-- Name: eav_entity; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.eav_entity (
                                   id integer NOT NULL,
                                   eav_type_id integer,
                                   name character varying
);


ALTER TABLE public.eav_entity OWNER TO postgres;

--
-- TOC entry 217 (class 1259 OID 16441)
-- Name: eav_entity_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.eav_entity ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.eav_entity_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 216 (class 1259 OID 16434)
-- Name: eav_type; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.eav_type (
                                 id integer NOT NULL,
                                 eav_code character varying,
                                 type character varying
);


ALTER TABLE public.eav_type OWNER TO postgres;

--
-- TOC entry 215 (class 1259 OID 16433)
-- Name: eav_type_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.eav_type ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.eav_type_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 220 (class 1259 OID 16450)
-- Name: eav_value; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.eav_value (
                                  id integer NOT NULL,
                                  eav_entity_id integer,
                                  movie_id integer,
                                  text_value character varying,
                                  bool_value boolean,
                                  date_value date
);


ALTER TABLE public.eav_value OWNER TO postgres;

--
-- TOC entry 219 (class 1259 OID 16449)
-- Name: eav_value_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.eav_value ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.eav_value_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 222 (class 1259 OID 16458)
-- Name: movie; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.movie (
                              id integer NOT NULL,
                              name character varying
);


ALTER TABLE public.movie OWNER TO postgres;

--
-- TOC entry 221 (class 1259 OID 16457)
-- Name: movie_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.movie ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.movie_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 223 (class 1259 OID 16500)
-- Name: view1; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.view1 AS
SELECT eav_value.text_value AS value,
    movie.name,
    eav_entity.name AS option_name
   FROM (((public.eav_value
     JOIN public.movie ON ((movie.id = eav_value.movie_id)))
     JOIN public.eav_entity ON ((eav_entity.id = eav_value.eav_entity_id)))
     JOIN public.eav_type ON (((eav_type.id = eav_entity.eav_type_id) AND ((eav_entity.eav_type_id = 3) OR (eav_entity.eav_type_id = 4)))));


ALTER VIEW public.view1 OWNER TO postgres;

--
-- TOC entry 224 (class 1259 OID 16504)
-- Name: view2; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.view2 AS
SELECT eav_value.text_value AS value,
    eav_value.bool_value,
    eav_value.date_value,
    movie.name,
    eav_entity.name AS option_name
   FROM ((public.eav_value
     JOIN public.movie ON ((movie.id = eav_value.movie_id)))
     JOIN public.eav_entity ON ((eav_entity.id = eav_value.eav_entity_id)));


ALTER VIEW public.view2 OWNER TO postgres;

--
-- TOC entry 3385 (class 0 OID 16442)
-- Dependencies: 218
-- Data for Name: eav_entity; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (1, 1, 'рецензии критиков');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (2, 1, 'рецензии киноакадемии');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (3, 2, 'оскар');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (4, 2, 'ника');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (5, 3, 'мировая премьера');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (6, 3, 'премьера в рф');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (7, 4, 'продажа билетов');
INSERT INTO public.eav_entity (id, eav_type_id, name) VALUES (8, 4, 'запуск рекламы');


--
-- TOC entry 3383 (class 0 OID 16434)
-- Dependencies: 216
-- Data for Name: eav_type; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.eav_type (id, eav_code, type) VALUES (1, 'review', 'text');
INSERT INTO public.eav_type (id, eav_code, type) VALUES (2, 'award', 'bool');
INSERT INTO public.eav_type (id, eav_code, type) VALUES (3, 'important_date', 'date');
INSERT INTO public.eav_type (id, eav_code, type) VALUES (4, 'service_date', 'date');


--
-- TOC entry 3387 (class 0 OID 16450)
-- Dependencies: 220
-- Data for Name: eav_value; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.eav_value (id, eav_entity_id, movie_id, text_value, bool_value, date_value) VALUES (1, 1, 1, 'хороший фильм', NULL, NULL);
INSERT INTO public.eav_value (id, eav_entity_id, movie_id, text_value, bool_value, date_value) VALUES (2, 2, 2, 'плохой фильм', NULL, NULL);
INSERT INTO public.eav_value (id, eav_entity_id, movie_id, text_value, bool_value, date_value) VALUES (3, 3, 1, NULL, true, NULL);
INSERT INTO public.eav_value (id, eav_entity_id, movie_id, text_value, bool_value, date_value) VALUES (4, 4, 1, NULL, true, NULL);
INSERT INTO public.eav_value (id, eav_entity_id, movie_id, text_value, bool_value, date_value) VALUES (5, 5, 1, NULL, NULL, '2024-12-08');


--
-- TOC entry 3389 (class 0 OID 16458)
-- Dependencies: 222
-- Data for Name: movie; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.movie (id, name) VALUES (1, 'movie1');
INSERT INTO public.movie (id, name) VALUES (2, 'movie2');


--
-- TOC entry 3395 (class 0 OID 0)
-- Dependencies: 217
-- Name: eav_entity_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.eav_entity_id_seq', 8, true);


--
-- TOC entry 3396 (class 0 OID 0)
-- Dependencies: 215
-- Name: eav_type_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.eav_type_id_seq', 4, true);


--
-- TOC entry 3397 (class 0 OID 0)
-- Dependencies: 219
-- Name: eav_value_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.eav_value_id_seq', 5, true);


--
-- TOC entry 3398 (class 0 OID 0)
-- Dependencies: 221
-- Name: movie_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.movie_id_seq', 2, true);


--
-- TOC entry 3229 (class 2606 OID 16448)
-- Name: eav_entity eav_entity_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_entity
    ADD CONSTRAINT eav_entity_pkey PRIMARY KEY (id);


--
-- TOC entry 3227 (class 2606 OID 16440)
-- Name: eav_type eav_type_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_type
    ADD CONSTRAINT eav_type_pkey PRIMARY KEY (id);


--
-- TOC entry 3231 (class 2606 OID 16456)
-- Name: eav_value eav_value_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_value
    ADD CONSTRAINT eav_value_pkey PRIMARY KEY (id);


--
-- TOC entry 3233 (class 2606 OID 16464)
-- Name: movie movie_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.movie
    ADD CONSTRAINT movie_pkey PRIMARY KEY (id);


--
-- TOC entry 3234 (class 2606 OID 16465)
-- Name: eav_entity eav_entity_eav_type_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_entity
    ADD CONSTRAINT eav_entity_eav_type_id_fkey FOREIGN KEY (eav_type_id) REFERENCES public.eav_type(id);


--
-- TOC entry 3235 (class 2606 OID 16470)
-- Name: eav_value eav_value_eav_entity_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_value
    ADD CONSTRAINT eav_value_eav_entity_id_fkey FOREIGN KEY (eav_entity_id) REFERENCES public.eav_entity(id);


--
-- TOC entry 3236 (class 2606 OID 16475)
-- Name: eav_value eav_value_movie_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eav_value
    ADD CONSTRAINT eav_value_movie_id_fkey FOREIGN KEY (movie_id) REFERENCES public.movie(id);


-- Completed on 2024-07-26 21:29:07 UTC

--
-- PostgreSQL database dump complete
--
