CREATE TABLE IF NOT EXISTS movie (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    duration INTERVAL NOT NULL,
    rating NUMERIC(2, 1) CHECK (rating >= 0 AND rating <= 10)
);

INSERT INTO movie (title, description, duration, rating)
VALUES ('Довод', 'Главный герой — секретный агент, который проходит жестокий тест на надежность и присоединяется к невероятной миссии. От ее выполнения зависит судьба мира, а для успеха необходимо отбросить все прежние представления о пространстве и времени.', '2 hour', 8.5),
       ('Аватар', 'Джейк Салли — бывший морской пехотинец, прикованный к инвалидному креслу. Несмотря на немощное тело, Джейк в душе по-прежнему остается воином. Он получает задание совершить путешествие в несколько световых лет к базе землян на планете Пандора, где корпорации добывают редкий минерал, имеющий огромное значение для выхода Земли из энергетического кризиса.', '3 hour', 9.0),
       ('Вызов', 'Торакальный хирург Женя за месяц должна подготовиться к космическому полету и отправиться на МКС, чтобы спасти космонавта. Удастся ли ей справиться с испытаниями? Сможет ли она преодолеть неуверенность и страхи? Получится ли у нее провести сложнейшую операцию в условиях невесомости, от которой зависят шансы космонавта вернуться на Землю живым?', '144 min', 7.0);

CREATE TABLE IF NOT EXISTS cinema_room (
    id SERIAL PRIMARY KEY,
    number SMALLINT NOT NULL
);

INSERT INTO cinema_room (number) VALUES (1), (2), (3), (4);

CREATE TABLE IF NOT EXISTS place_type (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL
);

INSERT INTO place_type (title) VALUES ('Эконом'), ('Комфорт'), ('VIP');

CREATE TABLE IF NOT EXISTS place (
    id SERIAL PRIMARY KEY,
    row SMALLINT NOT NULL,
    seat SMALLINT NOT NULL,
    cinema_room_id INTEGER NOT NULL,
    type_id INTEGER NOT NULL,
    CONSTRAINT fk_place_type FOREIGN KEY (type_id) REFERENCES place_type,
    CONSTRAINT fk_cinema_room FOREIGN KEY (cinema_room_id) REFERENCES cinema_room
)

INSERT INTO place (row, seat, cinema_room_id, type_id)
VALUES (1, 1, 1, 1),
    (1, 2, 1, 1),
    (1, 3, 1, 1),
    (1, 4, 1, 1),
    (2, 1, 1, 2),
    (2, 2, 1, 2),
    (2, 3, 1, 2),
    (2, 4, 1, 2),
    (3, 1, 1, 3),
    (3, 2, 1, 3),
    (3, 3, 1, 3),
    (3, 4, 1, 3),
    (1, 1, 2, 1),
    (1, 2, 2, 1),
    (1, 3, 2, 1),
    (1, 4, 2, 1),
    (2, 1, 2, 2),
    (2, 2, 2, 2),
    (2, 3, 2, 2),
    (2, 4, 2, 2),
    (3, 1, 2, 2),
    (3, 2, 2, 2),
    (3, 3, 2, 2),
    (3, 4, 2, 2),
    (1, 1, 3, 1),
    (1, 2, 3, 1),
    (1, 3, 3, 1),
    (1, 4, 3, 1),
    (2, 1, 3, 2),
    (2, 2, 3, 2),
    (2, 3, 3, 2),
    (2, 4, 3, 2),
    (3, 1, 3, 2),
    (3, 2, 3, 2),
    (3, 3, 3, 2),
    (3, 4, 3, 2),
    (1, 1, 4, 1),
    (1, 2, 4, 1),
    (1, 3, 4, 1),
    (1, 4, 4, 1),
    (2, 1, 4, 2),
    (2, 2, 4, 2),
    (2, 3, 4, 2),
    (2, 4, 4, 2),
    (3, 1, 4, 2),
    (3, 2, 4, 2),
    (3, 3, 4, 2),
    (3, 4, 4, 2);

CREATE TABLE IF NOT EXISTS movie_session (
    id SERIAL PRIMARY KEY,
    movie_id INTEGER NOT NULL,
    cinema_room_id INTEGER NOT NULL,
    start_time TIMESTAMP WITH TIME ZONE NOT NULL,
    CONSTRAINT fk_movie FOREIGN KEY (movie_id) REFERENCES movie,
    CONSTRAINT fk_cinema_room FOREIGN KEY (cinema_room_id) REFERENCES cinema_room
);

INSERT INTO movie_session(movie_id, cinema_room_id, start_time)
VALUES (1, 1, '2025-01-01 18:00:00+03'),
       (2, 2, '2025-01-01 18:00:00+03'),
       (3, 3, '2025-01-01 18:00:00+03'),
       (1, 4, '2025-01-01 22:00:00+03'),
       (2, 3, '2025-01-01 22:00:00+03'),
       (3, 2, '2025-01-01 22:00:00+03'),
       (1, 1, '2025-01-01 23:50:00+03');

CREATE TABLE IF NOT EXISTS price_place (
    id SERIAL PRIMARY KEY,
    movie_session_id INTEGER NOT NULL,
    place_id INTEGER NOT NULL,
    price NUMERIC(7, 2) NOT NULL,
    CONSTRAINT fk_movie_session FOREIGN KEY (movie_session_id) REFERENCES movie_session,
    CONSTRAINT fk_place FOREIGN KEY (place_id) REFERENCES place
);

INSERT INTO price_place(movie_session_id, place_id, price)
VALUES (1, 1, 100),
       (1, 2, 100),
       (1, 3, 100),
       (1, 4, 100),
       (1, 5, 100),
       (1, 6, 100),
       (1, 7, 100),
       (1, 8, 100),
       (1, 9, 100),
       (1, 10, 200),
       (1, 11, 200),
       (1, 12, 200),
       (1, 13, 200),
       (1, 14, 200),
       (1, 15, 200),
       (1, 16, 200),
       (1, 17, 200),
       (1, 18, 200),
       (1, 19, 200),
       (1, 20, 200),
       (1, 21, 200),
       (1, 22, 200),
       (1, 23, 200),
       (1, 24, 200),
       (1, 25, 200),
       (1, 26, 200),
       (1, 27, 200),
       (1, 28, 200),
       (1, 29, 200),
       (1, 30, 200),
       (1, 31, 200),
       (1, 32, 200),
       (1, 33, 200),
       (1, 34, 300),
       (1, 35, 300),
       (1, 36, 300),
       (1, 37, 300),
       (1, 38, 300),
       (1, 39, 300),
       (1, 40, 300),
       (1, 41, 300),
       (1, 42, 300),
       (1, 43, 300),
       (1, 44, 300),
       (1, 45, 300),
       (1, 46, 300),
       (1, 47, 300),
       (1, 48, 300),
       (2, 1, 300),
       (2, 2, 300),
       (2, 3, 300),
       (2, 4, 300),
       (2, 5, 300),
       (2, 6, 300),
       (2, 7, 300),
       (2, 8, 300),
       (2, 9, 300),
       (2, 10, 400),
       (2, 11, 400),
       (2, 12, 400),
       (2, 13, 400),
       (2, 14, 400),
       (2, 15, 400),
       (2, 16, 400),
       (2, 17, 400),
       (2, 18, 400),
       (2, 19, 400),
       (2, 20, 400),
       (2, 21, 400),
       (2, 22, 400),
       (2, 23, 400),
       (2, 24, 400),
       (2, 25, 400),
       (2, 26, 400),
       (2, 27, 400),
       (2, 28, 400),
       (2, 29, 400),
       (2, 30, 400),
       (2, 31, 400),
       (2, 32, 400),
       (2, 33, 400),
       (2, 34, 400),
       (2, 35, 400),
       (2, 36, 400),
       (2, 37, 400),
       (2, 38, 400),
       (2, 39, 400),
       (2, 40, 400),
       (2, 41, 400),
       (2, 42, 400),
       (2, 43, 450),
       (2, 44, 450),
       (2, 45, 450),
       (2, 46, 450),
       (2, 47, 450),
       (2, 48, 450),
       (3, 1, 100),
       (3, 2, 100),
       (3, 3, 100),
       (3, 4, 100),
       (3, 5, 100),
       (3, 6, 100),
       (3, 7, 100),
       (3, 8, 100),
       (3, 9, 100),
       (3, 10, 450),
       (3, 11, 450),
       (3, 12, 450),
       (3, 13, 450),
       (3, 14, 450),
       (3, 15, 450),
       (3, 16, 450),
       (3, 17, 450),
       (3, 18, 100),
       (3, 19, 450),
       (3, 20, 450),
       (3, 21, 450),
       (3, 22, 450),
       (3, 23, 450),
       (3, 24, 450),
       (3, 25, 450),
       (3, 26, 450),
       (3, 27, 450),
       (3, 28, 450),
       (3, 29, 450),
       (3, 30, 450),
       (3, 31, 450),
       (3, 32, 450),
       (3, 33, 450),
       (3, 34, 450),
       (3, 35, 450),
       (3, 36, 450),
       (3, 37, 450),
       (3, 38, 450),
       (3, 39, 450),
       (3, 40, 500),
       (3, 41, 500),
       (3, 42, 500),
       (3, 43, 500),
       (3, 44, 500),
       (3, 45, 500),
       (3, 46, 500),
       (3, 47, 500),
       (3, 48, 500),
       (4, 1, 100),
       (4, 2, 100),
       (4, 3, 100),
       (4, 4, 100),
       (4, 5, 100),
       (4, 6, 100),
       (4, 7, 100),
       (4, 8, 100),
       (4, 9, 100),
       (4, 10, 100),
       (4, 11, 100),
       (4, 12, 500),
       (4, 13, 500),
       (4, 14, 500),
       (4, 15, 500),
       (4, 16, 500),
       (4, 17, 500),
       (4, 18, 500),
       (4, 19, 500),
       (4, 20, 500),
       (4, 21, 500),
       (4, 22, 500),
       (4, 23, 500),
       (4, 24, 500),
       (4, 25, 500),
       (4, 26, 500),
       (4, 27, 500),
       (4, 28, 500),
       (4, 29, 500),
       (4, 30, 500),
       (4, 31, 500),
       (4, 32, 500),
       (4, 33, 500),
       (4, 34, 500),
       (4, 35, 500),
       (4, 36, 500),
       (4, 37, 500),
       (4, 38, 500),
       (4, 39, 500),
       (4, 40, 500),
       (4, 41, 500),
       (4, 42, 500),
       (4, 43, 500),
       (4, 44, 500),
       (4, 45, 500),
       (4, 46, 500),
       (4, 47, 500),
       (4, 48, 500),
       (5, 1, 100),
       (5, 2, 100),
       (5, 3, 100),
       (5, 4, 100),
       (5, 5, 100),
       (5, 6, 100),
       (5, 7, 100),
       (5, 8, 100),
       (5, 9, 100),
       (5, 10, 600),
       (5, 11, 600),
       (5, 12, 600),
       (5, 13, 600),
       (5, 14, 600),
       (5, 15, 600),
       (5, 16, 600),
       (5, 17, 600),
       (5, 18, 600),
       (5, 19, 600),
       (5, 20, 600),
       (5, 21, 600),
       (5, 22, 600),
       (5, 23, 600),
       (5, 24, 100),
       (5, 25, 600),
       (5, 26, 600),
       (5, 27, 600),
       (5, 28, 100),
       (5, 29, 600),
       (5, 30, 100),
       (5, 31, 600),
       (5, 32, 100),
       (5, 33, 600),
       (5, 34, 600),
       (5, 35, 600),
       (5, 36, 600),
       (5, 37, 100),
       (5, 38, 600),
       (5, 39, 100),
       (5, 40, 100),
       (5, 41, 100),
       (5, 42, 100),
       (5, 43, 100),
       (5, 44, 100),
       (5, 45, 100),
       (5, 46, 100),
       (5, 47, 100),
       (5, 48, 100),
       (6, 1, 100),
       (6, 2, 100),
       (6, 3, 100),
       (6, 4, 100),
       (6, 5, 100),
       (6, 6, 100),
       (6, 7, 100),
       (6, 8, 100),
       (6, 9, 100),
       (6, 10, 100),
       (6, 11, 100),
       (6, 12, 100),
       (6, 13, 100),
       (6, 14, 100),
       (6, 15, 800),
       (6, 16, 100),
       (6, 17, 100),
       (6, 18, 800),
       (6, 19, 100),
       (6, 20, 800),
       (6, 21, 100),
       (6, 22, 800),
       (6, 23, 100),
       (6, 24, 800),
       (6, 25, 100),
       (6, 26, 800),
       (6, 27, 100),
       (6, 28, 800),
       (6, 29, 100),
       (6, 30, 800),
       (6, 31, 100),
       (6, 32, 800),
       (6, 33, 100),
       (6, 34, 100),
       (6, 35, 800),
       (6, 36, 800),
       (6, 37, 100),
       (6, 38, 800),
       (6, 39, 100),
       (6, 40, 100),
       (6, 41, 800),
       (6, 42, 100),
       (6, 43, 800),
       (6, 44, 800),
       (6, 45, 800),
       (6, 46, 100),
       (6, 47, 100),
       (6, 48, 100),
       (7, 1, 100),
       (7, 2, 100),
       (7, 3, 100),
       (7, 4, 100),
       (7, 5, 100),
       (7, 6, 100),
       (7, 7, 100),
       (7, 8, 100),
       (7, 9, 100),
       (7, 10, 800),
       (7, 11, 800),
       (7, 12, 100),
       (7, 13, 800),
       (7, 14, 100),
       (7, 15, 800),
       (7, 16, 800),
       (7, 17, 800),
       (7, 18, 100),
       (7, 19, 800),
       (7, 20, 100),
       (7, 21, 100),
       (7, 22, 800),
       (7, 23, 800),
       (7, 24, 800),
       (7, 25, 800),
       (7, 26, 100),
       (7, 27, 800),
       (7, 28, 100),
       (7, 29, 100),
       (7, 30, 800),
       (7, 31, 100),
       (7, 32, 100),
       (7, 33, 100),
       (7, 34, 800),
       (7, 35, 800),
       (7, 36, 800),
       (7, 37, 800),
       (7, 38, 800),
       (7, 39, 100),
       (7, 40, 800),
       (7, 41, 100),
       (7, 42, 800),
       (7, 43, 100),
       (7, 44, 800),
       (7, 45, 800),
       (7, 46, 800),
       (7, 47, 800),
       (7, 48, 800);

CREATE TABLE client (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) NOT NULL
);

INSERT INTO client(email) VALUES ('test1@mail.ru'), ('test2@mail.ru'), ('test3@mail.ru');

CREATE TABLE ticket (
    id SERIAL PRIMARY KEY,
    client_id INTEGER NOT NULL,
    price_place_id INTEGER NOT NULL,
    CONSTRAINT fk_client FOREIGN KEY (client_id) REFERENCES client,
    CONSTRAINT fk_price_place FOREIGN KEY (price_place_id) REFERENCES price_place
);

INSERT INTO ticket (client_id, price_place_id)
VALUES (1, 1),
       (1, 10),
       (1, 100),
       (1, 200),
       (1, 300),
       (1, 102),
       (1, 104),
       (1, 106),
       (1, 202),
       (1, 204),
       (1, 206),
       (2, 2),
       (2, 20),
       (2, 101),
       (2, 201),
       (2, 301),
       (2, 105),
       (2, 107),
       (2, 109),
       (2, 203),
       (2, 205),
       (2, 207),
       (2, 307),
       (3, 3),
       (3, 30),
       (3, 102),
       (3, 211),
       (3, 311),
       (3, 115),
       (3, 117),
       (3, 119),
       (3, 213),
       (3, 215),
       (3, 217),
       (3, 317);