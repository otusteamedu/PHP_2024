# Test cases

[Файл](https://drive.google.com/file/d/1yAtmj9DE2yFeGh26WxDwr42j7RVbB_PI/view?usp=sharing) с вводными данными.

## Модульные тесты

- Если `card_number` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `card_number` содержит символы отличающиеся от цифр, то тестируемый метод возвращает код 400 с сообщением об
  ошибке.
- Если `card_number` содержит больше или меньше 16 цифр, то тестируемый метод возвращает код 400 с сообщением об
  ошибке.
- Если `card_holder` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `card_holder` содержит более одного пробела, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `card_holder` содержит символы отличные от латинских букв, пробела и дефиса, то тестируемый метод возвращает
  код 400 с сообщением об ошибке.
- Если `card_expiration` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `card_expiration` не соответствует шаблону `мм/гг`, то тестируемый метод возвращает код 400 с сообщением об
  ошибке.
- Если `cvv` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `cvv` состоит не из 3 символов, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `cvv` содержит что-то кроме цифр, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `order_number` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `order_number` состоит из более чем 16 символов, то тестируемый метод возвращает код 400 с сообщением об
  ошибке.
- Если `sum` не передан, то тестируемый метод возвращает код 400 с сообщением об ошибке.
- Если `sum` не соответствует шаблону `/^d+\,d{2}$/`, то тестируемый метод возвращает код 400 с сообщением об
  ошибке.
- Если переданные поля `card_number`, `card_holder`, `card_expiration`, `cvv`, `order_number` и `sum` - валидны,
  то тестируемый метод возвращает код 200 (т.к. это модульный тест, мы не обращаемся к **сервису А**)

## Интеграционные тесты

### Связка "фронт-бэк"

- Если `card_number` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем поле "
  номер карты" красной рамкой.
- Если `card_number` содержит символы отличающиеся от цифр, то после получения ответа от бэка на фронте выводим
  ошибку и выделяем поле "номер карты" красной рамкой.
- Если `card_number` содержит больше или меньше 16 цифр, то после получения ответа от бэка на фронте выводим
  ошибку и выделяем поле "номер карты" красной рамкой.
- Если `card_holder` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем поле "
  владелец карты" красной рамкой.
- Если `card_holder` содержит более одного пробела, то после получения ответа от бэка на фронте выводим ошибку и
  выделяем поле "владелец карты" красной рамкой.
- Если `card_holder` содержит символы отличные от латинских букв, пробела и дефиса, то после получения ответа от
  бэка на фронте выводим ошибку и выделяем поле "владелец карты" красной рамкой.
- Если `card_expiration` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем
  поле "месяц/год окончания действия карты" красной рамкой.
- Если `card_expiration` не соответствует шаблону `мм/гг`, то после получения ответа от бэка на фронте выводим
  ошибку и выделяем поле "месяц/год окончания действия карты" красной рамкой.
- Если `cvv` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем поле "код с
  обратной стороны карты" красной рамкой.
- Если `cvv` состоит не из 3 символов, то после получения ответа от бэка на фронте выводим ошибку и выделяем
  поле "код с обратной стороны карты" красной рамкой.
- Если `cvv` содержит что-то кроме цифр, то после получения ответа от бэка на фронте выводим ошибку и выделяем
  поле "код с обратной стороны карты" красной рамкой.
- Если `order_number` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем поле "
  номер заказа" красной рамкой.
- Если `order_number` состоит из более чем 16 символов, то после получения ответа от бэка на фронте выводим
  ошибку и выделяем поле "номер заказа" красной рамкой.
- Если `sum` не передан, то после получения ответа от бэка на фронте выводим ошибку и выделяем поле "сумма
  оплаты" красной рамкой.
- Если `sum` не соответствует шаблону `/^d+\,d{2}$/`, то после получения ответа от бэка на фронте выводим ошибку
  и выделяем поле "сумма оплаты" красной рамкой.
- Если фронт получил от бэка ответ с кодом 500, то на фронте выводим ошибку в общем блоке для отображения
  ошибок.

### Связка "бэк-сервис А"

- Если получили от **сервиса A** ошибку с кодом 403, то бэк возвращает ответ с кодом 500 вместе с сообщением об
  ошибке переданным сервисом A.
- Если получили от **сервиса A** ответ с кодом 200, то проверяем отсутствие ошибок.

### Связка "бэк-репозиторий"

- Если метод `setOrderIsPaid` вернул `true`, то бэк возвращает ответ с кодом 200;
- Если метод `setOrderIsPaid` выбросил исключение, бек должен его поймать и вернуть ответ с кодом 500 и сообщением
  об ошибке взятым из исключения метода `setOrderIsPaid`.

## Системные тесты

- Если `cvv` неверен, то после получения ответа от бэка на фронте выводится сообщение об ошибке "Не удалось списать
  данные с карты, проверьте реквизиты".
- Если владелец карты указан неверно, то после получения ответа от бэка на фронте выводится сообщение об ошибке "
  Проверьте, правильно ли указан владелец карты".
- Если все данные правильные и не произошло других ошибок, то на фронте выводим сообщение "Оплата прошла успешно".
- Если все данные правильные и не произошло других ошибок, то в репозитории заказ должен перейти в состояние "
  Оплачен".
