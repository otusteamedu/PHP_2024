--
-- PostgreSQL database dump
--

-- Dumped from database version 12.15 (Ubuntu 12.15-0ubuntu0.20.04.1)
-- Dumped by pg_dump version 12.15 (Ubuntu 12.15-0ubuntu0.20.04.1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: attribute_types; Type: TABLE; Schema: public; Owner: denis
--

CREATE TABLE public.attribute_types (
    id integer NOT NULL,
    name character varying(255)
);


ALTER TABLE public.attribute_types OWNER TO denis;

--
-- Name: attribute_types_id_seq; Type: SEQUENCE; Schema: public; Owner: denis
--

CREATE SEQUENCE public.attribute_types_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.attribute_types_id_seq OWNER TO denis;

--
-- Name: attribute_types_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: denis
--

ALTER SEQUENCE public.attribute_types_id_seq OWNED BY public.attribute_types.id;


--
-- Name: attributes; Type: TABLE; Schema: public; Owner: denis
--

CREATE TABLE public.attributes (
    id integer NOT NULL,
    name character varying(255),
    attribute_type_id integer
);


ALTER TABLE public.attributes OWNER TO denis;

--
-- Name: attributes_id_seq; Type: SEQUENCE; Schema: public; Owner: denis
--

CREATE SEQUENCE public.attributes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.attributes_id_seq OWNER TO denis;

--
-- Name: attributes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: denis
--

ALTER SEQUENCE public.attributes_id_seq OWNED BY public.attributes.id;


--
-- Name: films; Type: TABLE; Schema: public; Owner: denis
--

CREATE TABLE public.films (
    id integer NOT NULL,
    name character varying(255)
);


ALTER TABLE public.films OWNER TO denis;

--
-- Name: films_id_seq; Type: SEQUENCE; Schema: public; Owner: denis
--

CREATE SEQUENCE public.films_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.films_id_seq OWNER TO denis;

--
-- Name: films_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: denis
--

ALTER SEQUENCE public.films_id_seq OWNED BY public.films.id;


--
-- Name: values; Type: TABLE; Schema: public; Owner: denis
--

CREATE TABLE public."values" (
    film_id integer,
    attribute_id integer,
    value_int integer,
    value_dec numeric(10,2),
    value_text text,
    value_date date,
    value_bool boolean
);


ALTER TABLE public."values" OWNER TO denis;

--
-- Name: marketing; Type: VIEW; Schema: public; Owner: denis
--

CREATE VIEW public.marketing AS
 SELECT films.name AS film_name,
    concat(attr_types.name, ' - ', attrs.name) AS attribute,
    "values".value_text,
    "values".value_bool,
    "values".value_date
   FROM (((public."values" "values"
     LEFT JOIN public.films films ON ((films.id = "values".film_id)))
     LEFT JOIN public.attributes attrs ON ((attrs.id = "values".attribute_id)))
     LEFT JOIN public.attribute_types attr_types ON ((attr_types.id = attrs.attribute_type_id)));


ALTER TABLE public.marketing OWNER TO denis;

--
-- Name: tasks_in_20_days; Type: VIEW; Schema: public; Owner: denis
--

CREATE VIEW public.tasks_in_20_days AS
 SELECT films.name AS film_name,
    attr_types.name AS attribute_type,
    attrs.name AS attribute,
    "values".value_date
   FROM (((public."values" "values"
     LEFT JOIN public.films films ON ((films.id = "values".film_id)))
     LEFT JOIN public.attributes attrs ON ((attrs.id = "values".attribute_id)))
     LEFT JOIN public.attribute_types attr_types ON ((attr_types.id = attrs.attribute_type_id)))
  WHERE (((attr_types.name)::text = 'service_dates'::text) AND ("values".value_date >= (CURRENT_DATE + 20)));


ALTER TABLE public.tasks_in_20_days OWNER TO denis;

--
-- Name: tasks_today; Type: VIEW; Schema: public; Owner: denis
--

CREATE VIEW public.tasks_today AS
 SELECT films.name AS film_name,
    attr_types.name AS attribute_type,
    attrs.name AS attribute,
    "values".value_date
   FROM (((public."values" "values"
     LEFT JOIN public.films films ON ((films.id = "values".film_id)))
     LEFT JOIN public.attributes attrs ON ((attrs.id = "values".attribute_id)))
     LEFT JOIN public.attribute_types attr_types ON ((attr_types.id = attrs.attribute_type_id)))
  WHERE (((attr_types.name)::text = 'service_dates'::text) AND ("values".value_date = CURRENT_DATE));


ALTER TABLE public.tasks_today OWNER TO denis;

--
-- Name: attribute_types id; Type: DEFAULT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.attribute_types ALTER COLUMN id SET DEFAULT nextval('public.attribute_types_id_seq'::regclass);


--
-- Name: attributes id; Type: DEFAULT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.attributes ALTER COLUMN id SET DEFAULT nextval('public.attributes_id_seq'::regclass);


--
-- Name: films id; Type: DEFAULT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.films ALTER COLUMN id SET DEFAULT nextval('public.films_id_seq'::regclass);


--
-- Data for Name: attribute_types; Type: TABLE DATA; Schema: public; Owner: denis
--

COPY public.attribute_types (id, name) FROM stdin;
1	reviews
2	awards
3	important_dates
4	service_dates
\.


--
-- Data for Name: attributes; Type: TABLE DATA; Schema: public; Owner: denis
--

COPY public.attributes (id, name, attribute_type_id) FROM stdin;
1	critics reviews	1
2	review by an unknown film academy	1
3	Nika	2
4	Oskar	2
5	World premiere	3
6	Russian premiere	3
7	ticket opening date	4
8	running TV commercials	4
\.


--
-- Data for Name: films; Type: TABLE DATA; Schema: public; Owner: denis
--

COPY public.films (id, name) FROM stdin;
1	name_1
2	name_2
3	name_3
4	name_4
\.


--
-- Data for Name: values; Type: TABLE DATA; Schema: public; Owner: denis
--

COPY public."values" (film_id, attribute_id, value_int, value_dec, value_text, value_date, value_bool) FROM stdin;
1	1	\N	\N	best	\N	\N
1	2	\N	\N	middle	\N	\N
1	3	\N	\N	\N	\N	t
1	4	\N	\N	\N	\N	f
1	5	\N	\N	\N	2024-10-22	\N
1	6	\N	\N	\N	2024-10-25	\N
1	7	\N	\N	\N	2024-10-26	\N
1	8	\N	\N	\N	2024-09-06	\N
2	1	\N	\N	bad	\N	\N
2	2	\N	\N	middle	\N	\N
2	3	\N	\N	\N	\N	f
2	4	\N	\N	\N	\N	f
2	5	\N	\N	\N	2024-10-22	\N
2	6	\N	\N	\N	2024-10-25	\N
2	7	\N	\N	\N	2024-10-26	\N
2	8	\N	\N	\N	2024-09-06	\N
3	1	\N	\N	good	\N	\N
3	2	\N	\N	middle	\N	\N
3	3	\N	\N	\N	\N	f
3	4	\N	\N	\N	\N	t
3	5	\N	\N	\N	2024-10-22	\N
3	6	\N	\N	\N	2024-10-25	\N
3	7	\N	\N	\N	2024-10-26	\N
3	8	\N	\N	\N	2024-09-06	\N
4	1	\N	\N	good	\N	\N
4	2	\N	\N	middle	\N	\N
4	3	\N	\N	\N	\N	f
4	4	\N	\N	\N	\N	t
4	5	\N	\N	\N	2024-10-22	\N
4	6	\N	\N	\N	2024-10-25	\N
4	7	\N	\N	\N	2024-10-26	\N
4	8	\N	\N	\N	2024-12-06	\N
\.


--
-- Name: attribute_types_id_seq; Type: SEQUENCE SET; Schema: public; Owner: denis
--

SELECT pg_catalog.setval('public.attribute_types_id_seq', 4, true);


--
-- Name: attributes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: denis
--

SELECT pg_catalog.setval('public.attributes_id_seq', 8, true);


--
-- Name: films_id_seq; Type: SEQUENCE SET; Schema: public; Owner: denis
--

SELECT pg_catalog.setval('public.films_id_seq', 4, true);


--
-- Name: attribute_types attribute_types_pkey; Type: CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.attribute_types
    ADD CONSTRAINT attribute_types_pkey PRIMARY KEY (id);


--
-- Name: attributes attributes_pkey; Type: CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.attributes
    ADD CONSTRAINT attributes_pkey PRIMARY KEY (id);


--
-- Name: films films_pkey; Type: CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.films
    ADD CONSTRAINT films_pkey PRIMARY KEY (id);


--
-- Name: entity_idx; Type: INDEX; Schema: public; Owner: denis
--

CREATE INDEX entity_idx ON public."values" USING btree (film_id, attribute_id);


--
-- Name: value_date_idx; Type: INDEX; Schema: public; Owner: denis
--

CREATE INDEX value_date_idx ON public."values" USING btree (value_date);


--
-- Name: attributes attributes_attribute_type_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public.attributes
    ADD CONSTRAINT attributes_attribute_type_id_fkey FOREIGN KEY (attribute_type_id) REFERENCES public.attribute_types(id);


--
-- Name: values values_attribute_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public."values"
    ADD CONSTRAINT values_attribute_id_fkey FOREIGN KEY (attribute_id) REFERENCES public.attributes(id);


--
-- Name: values values_film_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: denis
--

ALTER TABLE ONLY public."values"
    ADD CONSTRAINT values_film_id_fkey FOREIGN KEY (film_id) REFERENCES public.films(id);


--
-- PostgreSQL database dump complete
--

