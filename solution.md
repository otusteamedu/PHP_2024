**Хранение данных**

Храним данные в `sorted sets`. Одно множество для каждого источника. Таким образом, у нас будут множества примерно с такими ключами:

- `'airplane:events:планер'`
- `'airplane:events:силовая установка'`
- `'airplane:events:шасси'`
- `'airplane:events:тормозная система'`
- `'airplane:events:бортовое оборудование'`

Множество содержит в себе события, у которых в качестве источника указан тот источник, название которого фигурирует в ключе множества. Событие дублируется во столько множеств, сколько у него источников.
`payload` события указываем через какой-нибудь разделитель после названия события, например, через `=>`. При получении событий по запросу пользователей производим обработку этой строки, разделяя событие и `payload`, в клиентском коде.
В качестве `score` у множества указываем приоритет события.

<u>Примеры добавления событий:</u>

```bash
ZADD 'airplane:events:планер' 10000 'event1:{id:141}' 400 'event2:{id:6810,severity:"Bug"}' 1500 'event3:{id:555}'
ZADD 'airplane:events:силовая установка' 400 'event2=>{id:6810,severity:"Bug"}' 1500 'event3=>{id:555}'
ZADD 'airplane:events:шасси' 1500 'event3=>{id:555}'
```

**Получение данных**

1. Получаем от пользователя названия источников.
2. Преобразуем их в ключи множеств.
3. Ключи передаем на вход команде `ZINTER`.
4. Нормализуем значения приоритетов через `AGGREGATE MIN`.
5. Инвертируем сортировку через умножение приоритетов на -1 `WEIGHTS -1`.

   <u>Например:</u>

```bash
ZINTER 2 'airplane:events:планер' 'airplane:events:силовая установка' AGGREGATE MIN WEIGHTS -1 -1
1) "event3=>{id:555}"
2) "event2=>{id:6810,severity:\"Bug\"}"
```

6. Полученные строки, как было написано выше, разделяем на название события и `payload`, используя разделитель `=>`.
